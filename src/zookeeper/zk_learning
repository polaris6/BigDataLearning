Zookeeper：分布式应用程序协调服务

一、介绍
    Zookeeper（动物园管理员）是一个分布式应用程序协调服务，主要用来解决分布式集群中应用系统的一致性问题，Zookeeper提供
的服务包括：命名服务、配置管理、集群管理、分布式锁、队列管理等，虽然可以提供多种服务，但是Zookeeper在底层其实只提供了
两个功能（管理数据和监听数据），所以可以简单理解为 Zookeeper = 文件系统 + 通知机制。


二、数据模型和存储
1、目录树结构：
    Zookeeper提供一种类似目录树结构的数据模型（详见图），ZooKeeper节点称为znode，每个节点（znode）具有唯一的路径标识，
路径是绝对路径，由斜线分隔开的路径名序列组成，和标准的文件系统非常类似。

2、znode：
    每个znode都可以存储数据，ZooKeeper旨在存储协调数据：状态信息、配置信息、位置信息等，因此存储在每个节点的数据量通常
很小，每个节点的存放数据上限为1M。znode兼具文件和目录两种特点，既像文件一样存储着数据、元数据，又像目录一样可以作为路径
标识的一部分，每个znode由三部分组成：
    ① stat：为状态信息，每个stat仅提供一个znode的元数据，包括版本号、操作控制列表(ACL)、znode创建的时间、znode最后修改
的时间、znode的数据长度、znode子节点数量等
    ② data：与该znode关联的数据
    ③ children：该znode的子节点
    注：Zookeeper并不是用来专门存储数据的，它的作用主要是用来维护和监控你存储的数据的状态变化，通过监控这些数据状态的
变化，从而达到基于数据的集群管理。ZooKeeper数据保存在内存中，这意味着ZooKeeper可以实现高吞吐和低延迟。

3、数据访问：
    znode具有原子性操作，每个znode的数据将被原子性地读写，读操作会读取与znode相关的所有数据，写操作会一次性替换所有数据。
另外，每一个节点都拥有自己的ACL（操作控制列表），这个列表规定了用户的权限，即限定了特定用户对目标节点可以执行的操作。

4、节点类型：
    znode节点有两种，分为临时节点和永久节点，节点的类型在创建时即被确定，并且不能改变。
    ① 临时节点：Zookeeper的客户端和服务器通信采用长连接方式，每个客户端和服务器通过心跳来保持连接，这个连接状态称为
session。如果znode是临时节点，这个session（会话）失效，znode也就被删除了。另外，ZooKeeper的临时节点不允许拥有子节点。
    ② 永久节点：客户端和服务器断开连接后，该节点依旧存在。

5、监听（watches）：
    客户端可以在znode上注册watch，当节点状态发生改变时（znode的增、删、改）将会触发watch，ZooKeeper会向客户端发送通知，
然后客户端可以根据znode变化来做出业务上的改变。watch只能被触发一次，触发后就被移除。
    补充：当客户端向ZooKeeper服务器注册watcher的同时，会将watcher对象存储在客户端的WatchManager中。当ZooKeeper服务器
触发watch事件后，会向客户端发送通知，客户端线程从WatchManager中取出对应的watcher对象来执行回调逻辑，从而实现对watch事件
的处理。
    个人理解：watch是事件（监听事件），watcher是具体的实现类；一个是从业务层面说的，一个是从代码实现层面说的。



